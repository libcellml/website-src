<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.16 -->
<document source="/Users/kmoy001/libcellml/libcellml-tutorials/theory/theory_hh.rst">
    <target refid="hh-background"></target>
    <section ids="a-model-of-the-nerve-action-potential hh-background" names="a\ model\ of\ the\ nerve\ action\ potential hh_background">
        <title>A model of the nerve action potential</title>
        <paragraph>Here we describe the first (and most famous) model of nerve fibre electrophysiology based on the membrane ion channels that we have discussed in the last two sections.
            This is the work by Alan Hodgkin and Andrew Huxley in 1952 cite <literal>10</literal> that won them (together with John Eccles) the 1963 Noble prize in Physiology or Medicine for <emphasis>“their discoveries concerning the ionic mechanisms involved in excitation and inhibition in
                the peripheral and central portions of the nerve cell membrane”</emphasis>.</paragraph>
        <topic classes="contents local" ids="contents" names="contents">
            <bullet_list>
                <list_item>
                    <paragraph><reference ids="id5" refid="theory-the-cable-equation">Theory: the cable equation</reference></paragraph>
                </list_item>
                <list_item>
                    <paragraph><reference ids="id6" refid="theory-action-potentials">Theory: Action potentials</reference></paragraph>
                </list_item>
                <list_item>
                    <paragraph><reference ids="id7" refid="interpretation-as-a-cellml-model">Interpretation as a CellML model</reference></paragraph>
                </list_item>
                <list_item>
                    <paragraph><reference ids="id8" refid="simulation-and-results">Simulation and results</reference></paragraph>
                </list_item>
            </bullet_list>
        </topic>
        <section ids="theory-the-cable-equation" names="theory:\ the\ cable\ equation">
            <title refid="id5">Theory: the cable equation</title>
            <paragraph>The <emphasis>cable equation</emphasis> was developed in 1890<footnote_reference auto="1" docname="theory/theory_hh" ids="id1" refid="id3">1</footnote_reference> to predict the degradation of an electrical signal passing along the transatlantic cable.
                It is derived as follows:</paragraph>
            <figure align="right" ids="ocr-tut-cur-flow-leaky" names="ocr_tut_cur_flow_leaky" width="6.5cm">
                <image alt="Current flow in a leaky cable" candidates="{'*': 'theory/images/current_flow_leaky_cable.png'}" uri="theory/images/current_flow_leaky_cable.png"></image>
                <caption>Current flow in a leaky cable.  <strong>TODO</strong> I don’t understand the vertical arrow??</caption>
            </figure>
            <paragraph>If the voltage is raised at the left hand end of the cable (shown by the deep red in <number_reference internal="True" refid="ocr-tut-cur-flow-leaky" title="Fig. %s"><inline classes="std std-numref">Fig. 22</inline></number_reference>), an axial current <math>i_a</math> (in <math>A</math>) will flow.
                This current depends on the voltage gradient according to Ohm’s Law, such that:</paragraph>
            <math_block docname="theory/theory_hh" label="True" nowrap="False" number="True" xml:space="preserve">- \frac{\partial V}{\partial x} = r_a i_a</math_block>
            <paragraph>where <math>\frac{\partial V}{\partial x}</math> is the voltage gradient along the cable (in <math>V/m</math>), and <math>r_a</math> is the resistance (in <math>\Omega/m</math>).</paragraph>
            <paragraph>If the cable membrane leaks a current of <math>i_m</math> (<math>A/m</math>) per unit length, then conservation of current gives:</paragraph>
            <math_block docname="theory/theory_hh" label="True" nowrap="False" number="True" xml:space="preserve">\frac{\partial i_a}{\partial x} = i_m</math_block>
            <paragraph>and, substituting for <math>i_a</math> we get:</paragraph>
            <math_block docname="theory/theory_hh" label="True" nowrap="False" number="True" xml:space="preserve">\frac{\partial}{\partial x}\left( - \frac{1}{r_a}\frac{\partial V}{\partial x} \right) = i_m</math_block>
            <paragraph>There are two sources of membrane leakage current, <math>i_m</math>.
                First, the capacitance associated with the membrane, <math>C_m</math> (approximately 1 <math>\mu F/cm^2</math>) results in a current of <math>C_m\frac{\partial V}{\partial t}</math>, and secondly the holes or channels in the membrane give <math>i_{leak}</math>.
                Incorporating these into the equation above gives:</paragraph>
            <math_block docname="theory/theory_hh" label="True" nowrap="False" number="True" xml:space="preserve">\frac{\partial}{\partial x}\left( - \frac{1}{r_a}\frac{\partial V}{\partial x} \right) = i_m = C_m\frac{\partial V}{\partial t} + i_{leak}</math_block>
            <paragraph>Rearranging gives the <strong>cable equation</strong> (for constant <math>r_a</math>):</paragraph>
            <math_block docname="theory/theory_hh" label="True" nowrap="False" number="True" xml:space="preserve">C_{m}\frac{\partial V}{\partial t} = - \frac{1}{r_a}\frac{\partial^2 V}{\partial x^2} - i_{leak}</math_block>
            <paragraph>where all terms represent <emphasis>current density</emphasis> (current per membrane area) and have units of <math>\mu A/cm^2</math>.</paragraph>
        </section>
        <section ids="theory-action-potentials" names="theory:\ action\ potentials">
            <title refid="id6">Theory: Action potentials</title>
            <figure align="right" ids="ocr-tut-cur-flow-neuron" names="ocr_tut_cur_flow_neuron" width="6.5cm">
                <image alt="Current flow in a neuron" candidates="{'*': 'theory/images/current_flow_neuron.png'}" uri="theory/images/current_flow_neuron.png"></image>
                <caption>Current flow in a neuron.  <strong>TODO</strong> I don’t understand the vertical arrow for V?? direction of voltage? Is one side in/out the cell?</caption>
            </figure>
            <paragraph>The cable equation above can be used to model the propagation of an action potential along a neuron or any other excitable cell.
                The leak current is associated primarily with the inward movement of sodium ions through the membrane’s sodium channel, giving the <emphasis>inward</emphasis> membrane current <math>i_{Na}</math>, and the outward movement of potassium ions through a membrane potassium channel, giving the <emphasis>outward</emphasis> current <math>i_K</math> (see <number_reference internal="True" refid="ocr-tut-cur-flow-neuron" title="Fig. %s"><inline classes="std std-numref">Fig. 23</inline></number_reference>).
                A further small leak current <math>i_L = g_L\left( V - E_L \right)</math> associated with chloride and other ions is also included.
                <strong>TODO</strong> Need to define E_L and g_L ??
                How is i_L related to i_leak above??</paragraph>
            <figure align="center" ids="ocr-tut-cur-volt-traj" names="ocr_tut_cur_volt_traj">
                <image alt="Current-voltage trajectory" candidates="{'*': 'theory/images/current_voltage_trajectory.png'}" uri="theory/images/current_voltage_trajectory.png"></image>
                <caption>Current-voltage trajectory during an action potential.</caption>
            </figure>
            <paragraph>When the membrane potential <math>V</math> rises due to axial current flow, the sodium (<math>Na^+</math>) channels open and the potassium (<math>K^+</math>) channels close, such that the membrane potential moves towards the Nernst potential for sodium.
                The subsequent decline of the Na channel conductance and the increasing K channel conductance as the voltage drops rapidly repolarises the membrane to its resting potential of -85mV (see <number_reference internal="True" refid="ocr-tut-cur-volt-traj" title="Fig. %s"><inline classes="std std-numref">Fig. 24</inline></number_reference>).</paragraph>
            <paragraph>If we assume that the whole cell is clamped with an axially-uniform potential then we can neglect<footnote_reference auto="1" docname="theory/theory_hh" ids="id2" refid="id4">2</footnote_reference> the term in the equation above representing the rate of change of axial current along the cable:</paragraph>
            <math_block docname="theory/theory_hh" label="True" nowrap="False" number="True" xml:space="preserve">- \frac{1}{r_a}\frac{\partial^{2}V}{\partial x^2} \approx 0</math_block>
            <paragraph>and so obtain the membrane potential <math>V</math> by integrating the first order ODE:</paragraph>
            <math_block docname="theory/theory_hh" label="True" nowrap="False" number="True" xml:space="preserve">\frac{dV}{dt} = \frac{- \left( i_{Na} + \ i_K + i_L \right)}{C_m}</math_block>
            <figure align="center" ids="ocr-tut-hh-1952" names="ocr_tut_hh_1952">
                <image alt="CellML schematic cell membrane model" candidates="{'*': 'theory/images/hodgkin_1952.png'}" uri="theory/images/hodgkin_1952.png"></image>
                <caption>A schematic cell diagram describing the current flows across the cell bilipid membrane that are captured in the Hodgkin-Huxley model.
                    The membrane ion channels are a sodium (Na<superscript>+</superscript>) channel, a potassium (K<superscript>+</superscript>) channel, and a leakage (L) channel (for chloride and other ions) through which the currents I<subscript>Na</subscript>, I<subscript>K</subscript> and I<subscript>L</subscript> flow, respectively.</caption>
            </figure>
            <paragraph>TODO How are the i_L and I_L in the figure related?  Consistent labelling needed?</paragraph>
        </section>
        <section ids="interpretation-as-a-cellml-model" names="interpretation\ as\ a\ cellml\ model">
            <title refid="id7">Interpretation as a CellML model</title>
            <paragraph>We discussed the idea and implementation of <emphasis>encapsulation</emphasis> in the <reference internal="True" refuri="theory_sodiumchannel#theory-sodiumchannel"><inline classes="std std-ref">previous section on the sodium channel</inline></reference>, and here it is no different.
                We would like to create a model with the encapsulation structure shown in <number_reference internal="True" refid="hh-encapsulation" title="Fig. %s"><inline classes="std std-numref">Fig. 26</inline></number_reference>.</paragraph>
            <figure align="center" ids="hh-encapsulation" names="hh_encapsulation">
                <image alt="CellML schematic HH model" candidates="{'*': 'theory/images/hh_encapsulation.png'}" uri="theory/images/hh_encapsulation.png"></image>
                <caption>The relationship between the ion channels for sodium, potassium and the leakage current, and the membrane and environment components.</caption>
            </figure>
            <paragraph>As with other aspects of libCellML, there are several options for the model construction process.
                Since we already have potassium and sodium channel models available, it would make sense to be able to reuse these here.
                This functionality requires <emphasis>imports</emphasis>; their use is demonstrated in <reference internal="True" refuri="../tutorials/hh_tutorials/tut2/index#createpotassiumchannelmodel"><inline classes="std std-ref">HH Tutorial 2: Creating a model which uses imports</inline></reference>.</paragraph>
            <paragraph>Importing allows all or part of a model to be used in-situ, without needing to manually parse its CellML file and instantiate it as an additional model (as has been the procedure in <reference internal="True" refuri="../tutorials/hh_tutorials/tut1/index#creategatemodel"><inline classes="std std-ref">HH Tutorial 1: Creating a model using the API</inline></reference> and <reference internal="True" refuri="../tutorials/hh_tutorials/tut3/index#debugsodiumchannelmodel"><inline classes="std std-ref">HH Tutorial 3: Debugging a model</inline></reference>).</paragraph>
        </section>
        <section ids="simulation-and-results" names="simulation\ and\ results">
            <title refid="id8">Simulation and results</title>
            <paragraph><reference internal="True" refuri="../tutorials/hh_tutorials/tut2/index#createpotassiumchannelmodel"><inline classes="std std-ref">HH Tutorial 2: Creating a model which uses imports</inline></reference> outlines how smaller models can be used to construct a more complicated model as described above.
                In this instance, the models described earlier representing a <reference internal="True" refuri="theory_potassiumchannel#theory-potassiumchannel"><inline classes="std std-ref">potassium channel</inline></reference> and a <reference internal="True" refuri="theory_sodiumchannel#theory-sodiumchannel"><inline classes="std std-ref">sodium channel</inline></reference>, as well as one to represent the leakage concept introduced above can be combined to make the full Hodgkin-Huxley model.</paragraph>
            <transition></transition>
            <rubric>Footnotes</rubric>
            <footnote auto="1" backrefs="id1" docname="theory/theory_hh" ids="id3" names="1">
                <label>1</label>
                <paragraph><reference refuri="http://en.wikipedia.org/wiki/Cable_theory">http://en.wikipedia.org/wiki/Cable_theory</reference></paragraph>
            </footnote>
            <footnote auto="1" backrefs="id2" docname="theory/theory_hh" ids="id4" names="2">
                <label>2</label>
                <paragraph>This term is needed when determining the propagation of the action potential, including its wave speed.</paragraph>
            </footnote>
        </section>
    </section>
</document>
